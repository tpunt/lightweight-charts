var w=Object.defineProperty;var I=(e,t,o)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var r=(e,t,o)=>I(e,typeof t!="symbol"?t+"":t,o);import{J as c,F as b,c as h,g as u,h as O}from"./sample-data-DmKHkXYO.js";import{C as g}from"./closest-index-BUfzSX6X.js";function x(e,...t){for(const o of t)for(const s in o)o[s]===void 0||!Object.prototype.hasOwnProperty.call(o,s)||["__proto__","constructor","prototype"].includes(s)||(typeof o[s]!="object"||e[s]===void 0||Array.isArray(o[s])?e[s]=o[s]:m(e[s],o[s]));return e}function m(e,...t){return x(e,...t)}function l(e){for(const t of e)if(typeof t.time!="number")throw new Error('All items must have a numeric "time" property.');return e}class C{constructor(t,o){r(this,"_series");r(this,"_options");r(this,"_indicatorSeries",null);r(this,"_chart",null);r(this,"_closestIndex",null);this._series=t,this._options=o}applyOptions(t){this._options=m(this._options,t),this._updateData()}attach(t){return this._indicatorSeries=t.addSeries(c,this._options.seriesOptions),this._updateData(),this._indicatorSeries}detach(){this._chart&&this._indicatorSeries&&(this._chart.removeSeries(this._indicatorSeries),this._indicatorSeries=null)}_updateData(){var s;this._closestIndex=new g(l(this._options.comparisonData));const o=l(this._series.data()).map(i=>{const f=this._closestIndex.findClosestIndex(i.time,"left"),n=this._options.comparisonData[f],p=this._options.mainSource??this._options.source,D=i[p]!==void 0,S=n[this._options.source]!==void 0;if(!n||!D||!S||!this._options.allowMismatchedDates&&n.time!==i.time)return{time:i.time};const y=n[this._options.source],v=i[p];return{time:i.time,value:v/y}});(s=this._indicatorSeries)==null||s.setData(o)}}function T(e,t){return new C(e,t)}const A={autoSize:!0},a=b("chart",A),F=h(u(250,new Date(2024,0,1))),d=h(u(250,new Date(2024,0,1))),_=a.addSeries(c,{color:"rgb(160, 0, 80)"});_.setData(F);const j=a.addSeries(c,{color:"rgb(80, 0, 160)"});j.setData(d);const H=T(_,{comparisonData:d,source:"value",seriesOptions:{lineStyle:O.Dotted,color:"black",lineWidth:1}});H.attach(a);a.timeScale().fitContent();
