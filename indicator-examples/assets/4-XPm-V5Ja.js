var m=Object.defineProperty;var f=(e,t,a)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var s=(e,t,a)=>f(e,typeof t!="symbol"?t+"":t,a);import{f as y,F as w,c as u,g as S,J as D}from"./sample-data-DhtW2yqE.js";import{c as g}from"./correlation-calculation-BfODByL7.js";import"./closest-index-BUfzSX6X.js";import"./timestamp-data-Dz1yihFk.js";function C(e,t,a){class b{constructor(){s(this,"_baseSeries",null);s(this,"_secondarySeries",null);s(this,"_indicatorSeries",null);s(this,"_chart",null);s(this,"_options",null);s(this,"_updateData",()=>{if(!this._indicatorSeries)return;if(!this._baseSeries||!this._secondarySeries){this._indicatorSeries.setData([]);return}const i=this._baseSeries.data(),n=this._secondarySeries.data(),r=g(i,n,this._options||a);this._indicatorSeries.setData(r)})}attached(i){const{chart:n,series:r}=i;this._chart=n,this._baseSeries=r,this._secondarySeries=t,this._indicatorSeries=this._chart.addSeries(y),this._options=a,r.subscribeDataChanged(this._updateData),this._secondarySeries.subscribeDataChanged(this._updateData),this._updateData()}detached(){var i;this._baseSeries&&this._baseSeries.unsubscribeDataChanged(this._updateData),this._secondarySeries&&this._secondarySeries.unsubscribeDataChanged(this._updateData),this._indicatorSeries&&((i=this._chart)==null||i.removeSeries(this._indicatorSeries)),this._indicatorSeries=null}indicatorSeries(){if(!this._indicatorSeries)throw new Error("unable to provide indicator series");return this._indicatorSeries}applyOptions(i){this._options={...this._options||{},...i},this._updateData()}}const h=new b;return e.attachPrimitive(h),h.indicatorSeries()}const v={autoSize:!0},o=w("chart",v),l=u(S(250,new Date(2024,0,1))),_=u(S(250,new Date(2024,0,1))),[T,I]=[l.slice(0,150),l.slice(150)],[O,P]=[_.slice(0,150),_.slice(150)],c=o.addSeries(D,{color:"rgb(160, 0, 80)"});c.setData(T);const d=o.addSeries(D,{color:"rgb(80, 0, 160)"});d.setData(O);const E=C(c,d,{length:20});E.moveToPane(1);o.timeScale().fitContent();function p(e){return new Promise(t=>{setTimeout(t,e)})}setTimeout(async()=>{for(const e of I)c.update(e),await p(100)},2e3);setTimeout(async()=>{for(const e of P)d.update(e),await p(100)},3e3);
