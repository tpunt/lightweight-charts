import{e as a}from"./timestamp-data-Dz1yihFk.js";function m(r){for(const e of r){if(typeof e.close=="number")return"close";if(typeof e.value=="number")return"value"}return null}function d(r,e){const n=e.source??m(r);if(!n)throw new Error("Please provide a `source` property for the moving average indicator.");a(r);const i=r.map(c=>c[n]),u=r.map(c=>c.time),o=l(i,e.length);let t=o;e.smoothingLine&&e.smoothingLength&&e.smoothingLength>1&&(t=h(o,e.smoothingLine,e.smoothingLength));let s=e.offset??0;return s!==0&&(s>0?t=Array(s).fill(void 0).concat(t.slice(0,t.length-s)):s<0&&(t=t.slice(-s).concat(Array(-s).fill(void 0)))),u.map((c,f)=>typeof t[f]=="number"?{time:c,value:t[f]}:{time:c})}function h(r,e,n){switch(e){case"SMA":return l(r,n);case"EMA":return v(r,n);case"WMA":return g(r,n);default:throw new Error("Unknown smoothing method: "+e)}}function l(r,e){const n=[];let i=0;const u=[];for(let o=0;o<r.length;++o){const t=r[o];if(typeof t!="number"){n.push(void 0);continue}if(u.push(t),i+=t,u.length>e){const s=u.shift();i-=s}u.length===e&&u.every(s=>!isNaN(s))?n.push(i/e):n.push(void 0)}return n}function v(r,e){const n=[];let i;const u=2/(e+1);for(let o=0;o<r.length;++o){const t=r[o];if(typeof t!="number"){n.push(void 0);continue}i===void 0?i=t:i=t*u+i*(1-u),n.push(i)}for(let o=0;o<e-1&&o<n.length;++o)n[o]=void 0;return n}function g(r,e){const n=[],i=Array.from({length:e},(o,t)=>t+1),u=i.reduce((o,t)=>o+t,0);for(let o=0;o<r.length;++o){if(o<e-1){n.push(void 0);continue}let t=0,s=!0;for(let c=0;c<e;++c){const f=r[o-e+1+c];if(typeof f!="number"){s=!1;break}t+=f*i[c]}n.push(s?t/u:void 0)}return n}export{d as c};
