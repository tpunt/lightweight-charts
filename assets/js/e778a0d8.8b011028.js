"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["35025"],{22742:function(e,t,n){n.d(t,{ZP:function(){return o},d$:function(){return i}});var a=n(85893),r=n(50065);let i=[];function s(e){let t={a:"a",admonition:"admonition",code:"code",li:"li",p:"p",ul:"ul",...(0,r.a)(),...e.components},{Details:n}=t;return n||function(e,t){throw Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(n,{children:[(0,a.jsx)("summary",{children:"How to use the code sample"}),(0,a.jsx)("strong",{children:"The code presented below requires:"}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["That ",(0,a.jsx)(t.code,{children:"createChart"})," has already been imported. See ",(0,a.jsx)(t.a,{href:"/docs#creating-a-chart",children:"Getting Started"})," for more information,"]}),"\n",(0,a.jsxs)(t.li,{children:["and that there is an html div element on the page with an ",(0,a.jsx)(t.code,{children:"id"})," of ",(0,a.jsx)(t.code,{children:"container"}),"."]}),"\n"]}),(0,a.jsxs)(t.p,{children:["Here is an example skeleton setup: ",(0,a.jsx)(t.a,{href:"https://codesandbox.io/s/lightweight-charts-skeleton-n67pm6",children:"Code Sandbox"}),".\nYou can paste the provided code below the ",(0,a.jsx)(t.code,{children:"// REPLACE EVERYTHING BELOW HERE"})," comment."]}),(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsx)(t.p,{children:"Some code may be hidden to improve readability. Toggle the checkbox above the code block to reveal all the code."})})]})}function o(e={}){let{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(s,{...e})}):s(e)}},39991:function(e,t,n){n.r(t),n.d(t,{default:()=>O,frontMatter:()=>l,metadata:()=>a,assets:()=>c,toc:()=>h,contentTitle:()=>d});var a=JSON.parse('{"id":"demos/infinite-history","title":"Infinite history","description":"An example of how to load historical data on demand","source":"@site/tutorials/demos/infinite-history.mdx","sourceDirName":"demos","slug":"/demos/infinite-history","permalink":"/lightweight-charts/tutorials/demos/infinite-history","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Infinite history","sidebar_label":"Infinite history","description":"An example of how to load historical data on demand","pagination_prev":null,"pagination_next":null,"keywords":["history"]},"sidebar":"tutorialsSidebar"}'),r=n("85893"),i=n("50065"),s=n("22742"),o=n("30353");let l={title:"Infinite history",sidebar_label:"Infinite history",description:"An example of how to load historical data on demand",pagination_prev:null,pagination_next:null,keywords:["history"]},d=void 0,c={},h=[];function u(e){let t={a:"a",code:"code",p:"p",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"This sample showcases the capability of Lightweight Charts\u2122 to manage and display\nan ever-expanding dataset, resembling a live feed that loads older data when the\nuser scrolls back in time. The example depicts a chart that initially loads a\nlimited amount of data, but later fetches additional data as required."}),"\n",(0,r.jsxs)(t.p,{children:["Key to this functionality is the\n",(0,r.jsx)(t.a,{href:"/docs/api/interfaces/ITimeScaleApi#subscribevisiblelogicalrangechange",children:(0,r.jsx)(t.code,{children:"subscribeVisibleLogicalRangeChange"})}),"\nmethod. This function is triggered when the visible data range changes, in this\ncase, when the user scrolls beyond the initially loaded data."]}),"\n",(0,r.jsxs)(t.p,{children:["By checking if the amount of unseen data on the left of the screen falls below a\ncertain threshold (in this example, 10 units), it's determined whether\nadditional data needs to be loaded. New data is appended through a simulated\ndelay using ",(0,r.jsx)(t.code,{children:"setTimeout"}),"."]}),"\n",(0,r.jsx)(t.p,{children:"This kind of infinite history functionality is typical of financial charts which\nfrequently handle large and continuously expanding datasets."}),"\n","\n",(0,r.jsx)(o.ZP,{replaceThemeConstants:!0,chart:!0,className:"language-js",hideableCode:!0,chartOnTop:!0,codeUsage:(0,r.jsx)(s.ZP,{}),children:"// remove-start\n// Lightweight Charts\u2122 Example: Infinite history\n// https://tradingview.github.io/lightweight-charts/tutorials/demos/infinite-history\n\n// remove-end\n\n// hide-start\nlet randomFactor = 25 + Math.random() * 25;\nconst samplePoint = i =>\n	i *\n		(0.5 +\n			Math.sin(i / 10) * 0.2 +\n			Math.sin(i / 20) * 0.4 +\n			Math.sin(i / randomFactor) * 0.8 +\n			Math.sin(i / 500) * 0.5) +\n	200;\n\nfunction generateLineData(numberOfPoints = 500, endDate) {\n	randomFactor = 25 + Math.random() * 25;\n	const res = [];\n	const date = endDate || new Date(Date.UTC(2018, 0, 1, 12, 0, 0, 0));\n	date.setUTCDate(date.getUTCDate() - numberOfPoints - 1);\n	for (let i = 0; i < numberOfPoints; ++i) {\n		const time = date.getTime() / 1000;\n		const value = samplePoint(i);\n		res.push({\n			time,\n			value,\n		});\n\n		date.setUTCDate(date.getUTCDate() + 1);\n	}\n\n	return res;\n}\n\nfunction randomNumber(min, max) {\n	return Math.random() * (max - min) + min;\n}\n\nfunction randomBar(lastClose) {\n	const open = +randomNumber(lastClose * 0.95, lastClose * 1.05).toFixed(2);\n	const close = +randomNumber(open * 0.95, open * 1.05).toFixed(2);\n	const high = +randomNumber(\n		Math.max(open, close),\n		Math.max(open, close) * 1.1\n	).toFixed(2);\n	const low = +randomNumber(\n		Math.min(open, close) * 0.9,\n		Math.min(open, close)\n	).toFixed(2);\n	return {\n		open,\n		high,\n		low,\n		close,\n	};\n}\n\nfunction generateCandleData(numberOfPoints = 250, endDate) {\n	const lineData = generateLineData(numberOfPoints, endDate);\n	let lastClose = lineData[0].value;\n	return lineData.map(d => {\n		const candle = randomBar(lastClose);\n		lastClose = candle.close;\n		return {\n			time: d.time,\n			low: candle.low,\n			high: candle.high,\n			open: candle.open,\n			close: candle.close,\n		};\n	});\n}\n\nclass Datafeed {\n	constructor() {\n		this._earliestDate = new Date(Date.UTC(2018, 0, 1, 12, 0, 0, 0));\n		this._data = [];\n	}\n\n	getBars(numberOfExtraBars) {\n		const historicalData = generateCandleData(\n			numberOfExtraBars,\n			this._earliestDate\n		);\n		this._data = [...historicalData, ...this._data];\n		this._earliestDate = new Date(historicalData[0].time * 1000);\n		return this._data;\n	}\n}\n\nconst chartOptions = {\n	layout: {\n		textColor: CHART_TEXT_COLOR,\n		background: { type: 'solid', color: CHART_BACKGROUND_COLOR },\n	},\n};\n// hide-end\nconst container = document.getElementById('container');\n// remove-line\n/** @type {import('lightweight-charts').IChartApi} */\nconst chart = createChart(container, chartOptions);\n\nconst series = chart.addSeries(CandlestickSeries, {\n	upColor: BAR_UP_COLOR,\n	downColor: BAR_DOWN_COLOR,\n	borderVisible: false,\n	wickUpColor: BAR_UP_COLOR,\n	wickDownColor: BAR_DOWN_COLOR,\n});\n\nconst datafeed = new Datafeed();\n\nseries.setData(datafeed.getBars(200));\n\nchart.timeScale().subscribeVisibleLogicalRangeChange(logicalRange => {\n	if (logicalRange.from < 10) {\n		// load more data\n		const numberBarsToLoad = 50 - logicalRange.from;\n		const data = datafeed.getBars(numberBarsToLoad);\n		setTimeout(() => {\n			series.setData(data);\n		}, 250); // add a loading delay\n	}\n});\n"})]})}function O(e={}){let{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},30353:function(e,t,n){n.d(t,{ZP:()=>_});var a=n("85893"),r=n("67294"),i=n("31705"),s=n("44634"),o=n("79207"),l=n("57378"),d=n("64926"),c=n("6646");function h(e,t,n){e.addEventListener("resize",()=>{let e=t.getBoundingClientRect();n(e.width,e.height)},!0)}let u={3.8:async e=>{let t=await n.e("70967").then(n.bind(n,51083));return{module:t,createChart:(n,a)=>{let r=t.createChart(n,a);return h(e,n,r.resize.bind(r)),r},createChartEx:void 0,createYieldCurveChart:void 0,createOptionsChart:void 0}},"4.0":async e=>{let t=await n.e("98966").then(n.bind(n,11413));return{module:t,createChart:(n,a)=>{let r=t.createChart(n,a);return h(e,n,r.resize.bind(r)),r},createChartEx:void 0,createYieldCurveChart:void 0,createOptionsChart:void 0}},4.1:async e=>{let t=await n.e("85998").then(n.bind(n,1860));return{module:t,createChart:(n,a)=>{let r=t.createChart(n,a);return h(e,n,r.resize.bind(r)),r},createChartEx:(n,a,r)=>{let i=t.createChartEx(n,a,r);return h(e,n,i.resize.bind(i)),i},createYieldCurveChart:void 0,createOptionsChart:void 0}},4.2:async e=>{let t=await n.e("15373").then(n.bind(n,15757));return{module:t,createChart:(n,a)=>{let r=t.createChart(n,a);return h(e,n,r.resize.bind(r)),r},createChartEx:(n,a,r)=>{let i=t.createChartEx(n,a,r);return h(e,n,i.resize.bind(i)),i},createYieldCurveChart:void 0,createOptionsChart:void 0}},"5.0":async e=>{let t=await n.e("11191").then(n.bind(n,96473));return{module:t,createChart:(n,a)=>{let r=t.createChart(n,a);return h(e,n,r.resize.bind(r)),r},createChartEx:(n,a,r)=>{let i=t.createChartEx(n,a,r);return h(e,n,i.resize.bind(i)),i},createYieldCurveChart:(n,a)=>{let r=t.createYieldCurveChart(n,a);return h(e,n,r.resize.bind(r)),r},createOptionsChart:(n,a)=>{let r=t.createOptionsChart(n,a);return h(e,n,r.resize.bind(r)),r}}},current:async()=>{let e=await n.e("22433").then(n.bind(n,3768));return{module:e,createChart:(t,n)=>{let a=e.createChart(t,n);return h(window,t,a.resize.bind(a)),a},createChartEx:(t,n,a)=>{let r=e.createChartEx(t,n,a);return h(window,t,r.resize.bind(r)),r},createYieldCurveChart:(t,n)=>{let a=e.createYieldCurveChart(t,n);return h(window,t,a.resize.bind(a)),a},createOptionsChart:(t,n)=>{let a=e.createOptionsChart(t,n);return h(window,t,a.resize.bind(a)),a}}}},O={iframe:"iframe_R_Fr"};function C(e){let{script:t,iframeStyle:n}=e,{preferredVersion:i}=(0,l.J)(),s=c&&c.length>0?c["0"]:"",o=i?.name??s??"current",h=`
		<style>
			html,
			body,
			#container {
				width: 100%;
				height: 100%;
				overflow: hidden;
				margin: 0;
			}
		</style>
		<div id="container"></div>
		<script>
			window.run = () => {
				${t}
			};
		</script>
	`,C=r.useRef(null),m="current"===o||parseInt(o.split(".")[0])>=5;return(r.useEffect(()=>{let e=C.current,t=e?.contentWindow,n=e?.contentDocument;if(null===e||!t||!n||!m)return;let a=async()=>{try{let{module:e,createChart:n,createChartEx:a,createYieldCurveChart:r,createOptionsChart:i}=await u[o](t);Object.assign(t,e),t.createChart=n,t.createChartEx=a,t.createYieldCurveChart=r,t.createOptionsChart=i,t.LineSeries=e.LineSeries,t.AreaSeries=e.AreaSeries,t.CandlestickSeries=e.CandlestickSeries,t.BarSeries=e.BarSeries,t.HistogramSeries=e.HistogramSeries,t.run?.()}catch(e){console.error(e)}};if(void 0!==t.run)a();else{let t=()=>{a(),e.removeEventListener("load",t)};e.addEventListener("load",t)}},[h]),m)?(0,a.jsx)("iframe",{ref:C,srcDoc:h,className:O.iframe,style:n},t):(0,a.jsx)("div",{children:(0,a.jsx)(d.Z,{type:"caution",title:"Chart visualization is not available for this version",children:(0,a.jsx)("p",{children:"Switch to a version 5 or higher to see the chart"})})})}var m=n("98159");let g=()=>`${Math.random().toString(36).slice(2,11)}`,p=Object.keys(m.l.DARK),_=e=>{let{chart:t,replaceThemeConstants:n,hideableCode:l,chartOnly:d,chartOnTop:c=!1,iframeStyle:h,replaceTabs:u=!0,codeUsage:_,...L}=e,{children:f}=e,{colorMode:b}=(0,o.I)(),R=function(){let[e,t]=(0,r.useState)("");return(0,r.useEffect)(()=>t(g()),[]),e}();if(n&&"string"==typeof f&&(f=function(e,t){let n=t?m.l.DARK:m.l.LIGHT,a=e;for(let e of p)a=a.replace(RegExp(e,"g"),`'${n[e]}'`);return a}(f,"dark"===b)),u&&"string"==typeof f&&(f=f.replace(/\t/g,"    ")),f=f.replace(RegExp(/\/\/ delete-start[\w\W]*?\/\/ delete-end/,"gm"),""),t||l){let e=!d&&(0,a.jsx)(i.Z,{...L,children:f}),n=t&&(0,a.jsx)(s.Z,{fallback:(0,a.jsx)("div",{className:O.iframe,children:"\xa0"}),children:()=>(0,a.jsx)(C,{script:f,iframeStyle:h})}),r=l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{id:R,type:"checkbox",className:"toggle-hidden-lines"}),(0,a.jsx)("label",{className:"toggle-label",htmlFor:R,children:"Show all code"})]});return c?(0,a.jsxs)(a.Fragment,{children:[n,_,r,e]}):(0,a.jsxs)(a.Fragment,{children:[_,r,e,n]})}return(0,a.jsx)(i.Z,{...L,children:f})}},98159:function(e,t,n){n.d(t,{l:function(){return a}});let a={DARK:{CHART_BACKGROUND_COLOR:"black",CHART_BACKGROUND_RGB_COLOR:"0, 0, 0",LINE_LINE_COLOR:"#2962FF",LINE_LINE2_COLOR:"rgb(225, 87, 90)",LINE_LINE3_COLOR:"rgb(242, 142, 44)",LINE_LINE4_COLOR:"rgb(164, 89, 209)",LINE_LINE5_COLOR:"rgb(27, 156, 133)",AREA_TOP_COLOR:"#2962FF",AREA_BOTTOM_COLOR:"rgba(41, 98, 255, 0.28)",BAR_UP_COLOR:"#26a69a",BAR_DOWN_COLOR:"#ef5350",BASELINE_TOP_LINE_COLOR:"rgba( 38, 166, 154, 1)",BASELINE_TOP_FILL_COLOR1:"rgba( 38, 166, 154, 0.28)",BASELINE_TOP_FILL_COLOR2:"rgba( 38, 166, 154, 0.05)",BASELINE_BOTTOM_LINE_COLOR:"rgba( 239, 83, 80, 1)",BASELINE_BOTTOM_FILL_COLOR1:"rgba( 239, 83, 80, 0.05)",BASELINE_BOTTOM_FILL_COLOR2:"rgba( 239, 83, 80, 0.28)",HISTOGRAM_COLOR:"#26a69a",CHART_TEXT_COLOR:"white"},LIGHT:{CHART_BACKGROUND_COLOR:"white",CHART_BACKGROUND_RGB_COLOR:"255, 255, 255",LINE_LINE_COLOR:"#2962FF",LINE_LINE2_COLOR:"rgb(225, 87, 90)",LINE_LINE3_COLOR:"rgb(242, 142, 44)",LINE_LINE4_COLOR:"rgb(164, 89, 209)",LINE_LINE5_COLOR:"rgb(27, 156, 133)",AREA_TOP_COLOR:"#2962FF",AREA_BOTTOM_COLOR:"rgba(41, 98, 255, 0.28)",BAR_UP_COLOR:"#26a69a",BAR_DOWN_COLOR:"#ef5350",BASELINE_TOP_LINE_COLOR:"rgba( 38, 166, 154, 1)",BASELINE_TOP_FILL_COLOR1:"rgba( 38, 166, 154, 0.28)",BASELINE_TOP_FILL_COLOR2:"rgba( 38, 166, 154, 0.05)",BASELINE_BOTTOM_LINE_COLOR:"rgba( 239, 83, 80, 1)",BASELINE_BOTTOM_FILL_COLOR1:"rgba( 239, 83, 80, 0.05)",BASELINE_BOTTOM_FILL_COLOR2:"rgba( 239, 83, 80, 0.28)",HISTOGRAM_COLOR:"#26a69a",CHART_TEXT_COLOR:"black"}}},6646:function(e){e.exports=JSON.parse('["5.0","4.2","4.1","4.0","3.8"]')}}]);